{"version":3,"file":"index.8f68585a.js","sources":["../../../resources/js/views/Document/modules/Views/modules/Pages/Bonds/index.vue"],"sourcesContent":["<template>\n  <Loader v-if=\"!priceAndProfitBond.price.length && priceAndProfitBond.price.length !== 0\"></Loader>\n  <div class=\"greyBg\" v-else>\n    <div v-if=\"bonds\" class=\"flexWrapperColumn\">\n\n      <div v-for=\"(bond, idx) in bonds\" :key=\"bond.NAME\" class=\"wrapper\">\n        <router-link\n          exact\n          :to=\"{\n            name: 'DocumentInfo',\n            params: {\n              locale: route.params.locale,\n              type: 'bond',\n              id: bond.CODE,\n              company: bond.NAME,\n            },\n          }\"\n          class=\"bond tableValue flexRowBetween\"\n        >\n          <div class=\"bond tableValue flexRowBetween\">\n            <p>{{ bond.NAME }}</p>\n            <p>{{ $t('bonds.isin') }} {{ bond.CODE }}</p>\n            <p>{{ $t('bonds.currentPrice')}}\n              <span v-if=\"priceAndProfitBond.price[idx]\">{{ priceAndProfitBond.price[idx] }}</span>\n              <span v-else class=\"loading\">...</span>\n            </p>\n            <p>{{ $t('bonds.totalValue') }}\n              <span v-if=\"priceAndProfitBond.profit[idx]\">{{ priceAndProfitBond.profit[idx] }}</span>\n              <span v-else class=\"loading\">...</span>\n            </p>\n          </div>\n        </router-link>\n      </div>\n    </div>\n    <h1 v-else class=\"flexWrapperColumn\">Информация об облигациях не найдена</h1>\n  </div>\n</template>\n<script lang=\"ts\">\nimport {defineComponent, ref, reactive, onMounted, onServerPrefetch, onActivated, onBeforeMount  } from 'vue';\nimport Loader from '@/components/Loader/index.vue';\nimport { useStore } from 'vuex';\nimport { useRoute } from 'vue-router';\nimport { useApiFinplan } from '@/use/api/useApiFinplan';\n\nexport default defineComponent({\n  name: 'DocumentBondsPage',\n  components: { Loader },\n\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const api = useApiFinplan();\n\n    const priceAndProfitBond = reactive({ price: [], profit: []})\n\n    const getInfoBond = async function() {\n      const bonds = store.getters['documentStore/getEmitentData'].OBLIGATIONS\n      const bondsList = []\n      const bondsPriceList = []\n      const bondsProfitList = []\n\n      bonds?.forEach(b => {\n        //@ts-ignore\n        bondsList.push(b.CODE)\n      })\n\n      try {\n        for (const b of bondsList) {\n          const res = await api.getBond('RUS', b)\n\n          //@ts-ignore\n          bondsPriceList.push(res.data['RADAR_DATA']['PROPS']['LASTPRICE'])\n          //@ts-ignore\n          bondsProfitList.push(res.data['RADAR_DATA']['DYNAM']['Доходность общая'] || '-')\n        }\n\n      } catch (e) {\n        console.log(e)\n      } finally {\n        if(priceAndProfitBond.price.length === 0) {\n          priceAndProfitBond.price = bondsPriceList\n        }\n\n        if(priceAndProfitBond.profit.length === 0) {\n          priceAndProfitBond.profit = bondsProfitList\n        }\n\n      }\n    }\n\n\n\n    onMounted(async () => {\n      await getInfoBond();\n    });\n\n\n    return {\n      bonds: store.getters['documentStore/getEmitentData'].OBLIGATIONS,\n      route,\n      priceAndProfitBond,\n    };\n  },\n});\n</script>\n<style scoped lang=\"scss\">\n.loading {\n  font-weight: bold;\n  display:inline-block;\n  font-family: monospace;\n  font-size: 10px;\n  color: #00a44c;\n  clip-path: inset(0 3ch 0 0);\n  animation: l 1s steps(4) infinite;\n}\n\n@keyframes l {\n  to {\n    clip-path: inset(0 -1ch 0 0)\n  }\n}\n.flexWrapperColumn {\n  margin: auto;\n}\n\n.wrapper {\n  position: relative;\n  margin-top: 5px;\n  overflow: hidden;\n  color: #fff;\n  background-color: white;\n  border-left: #fec006 5px solid;\n  cursor: pointer;\n\n  &:hover::before {\n    left: 0;\n  }\n\n  > a {\n    text-decoration: none;\n  }\n\n  &::before {\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 200%;\n    height: 100%;\n    background: linear-gradient(\n      to right,\n      rgb(254, 192, 6) 0%,\n      rgba(254, 192, 6, 1) 50%,\n      rgb(255, 255, 255) 50%,\n      rgb(255, 255, 255) 100%\n    );\n    transition: left 0.4s;\n    content: '';\n  }\n\n  .bond {\n    position: relative;\n    width: 100%;\n    padding: 15px 30px;\n\n    > p {\n      margin: 0;\n    }\n  }\n}\n\n@media (max-width: 1100px) {\n  .greyBg {\n    overflow-x: scroll;\n    .flexWrapperColumn {\n      .wrapper {\n        > a {\n          padding: 0;\n        }\n      }\n    }\n  }\n}\n\n@media (max-width: 1000px) {\n  .greyBg {\n    overflow-x: scroll;\n    .flexWrapperColumn {\n      padding: 20px;\n      .wrapper {\n        width: 900px;\n      }\n    }\n  }\n}\n</style>\n"],"names":["_sfc_main","defineComponent","Loader","store","useStore","route","useRoute","api","useApiFinplan","priceAndProfitBond","reactive","getInfoBond","__async","bonds","bondsList","bondsPriceList","bondsProfitList","b","res","e","onMounted","_hoisted_1","_hoisted_2","_hoisted_5","_hoisted_7","_hoisted_8","_resolveComponent","_ctx","_openBlock","_createBlock","_component_Loader","_createElementBlock","_Fragment","_renderList","bond","idx","_createVNode","_component_router_link","_withCtx","_createElementVNode","_hoisted_3","_toDisplayString","_createTextVNode","_hoisted_6"],"mappings":"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"}